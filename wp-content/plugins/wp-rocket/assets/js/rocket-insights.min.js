!function a(i,n,s){function o(e,t){if(!n[e]){if(!i[e]){var r="function"==typeof require&&require;if(!t&&r)return r(e,!0);if(d)return d(e,!0);throw(t=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",t}r=n[e]={exports:{}},i[e][0].call(r.exports,function(t){return o(i[e][1][t]||t)},r,r.exports,a,i,n,s)}return n[e].exports}for(var d="function"==typeof require&&require,t=0;t<s.length;t++)o(s[t]);return o}({1:[function(t,e,r){e.exports=(()=>{let a=5e3,i={};function t(){n(),s(),jQuery(".wpr-ri-loading").each(function(){var t=jQuery(this).closest(".wpr-ri-column"),e=t.data("rocket-insights-id"),r=t.data("url");e&&!i[e]&&d(e,0,t)})}function n(){jQuery(document).on("click",".wpr-ri-test-page",function(t){t.preventDefault();var i,n,t=jQuery(this),e=t.data("url"),r=t.closest(".wpr-ri-column");"1"===r.attr("data-can-add-pages")?(i=e,n=r,t.prop("disabled",!0),p(n,null),window.wp.apiFetch({path:"/wp-rocket/v1/rocket-insights/pages/",method:"POST",data:{page_url:i,source:"post type listing"}}).then(t=>{var e=!0===t?.success,r=t?.id??t?.data?.id??null,a=t?.can_add_pages??t?.data?.can_add_pages;t?.message??t?.data?.message;e&&r?(n.attr("data-rocket-insights-id",r),d(r,0,n),!1!==a&&0!==t?.data?.remaining_urls||jQuery(".wpr-ri-test-page").each(function(){jQuery(this).closest(".wpr-ri-column").attr("data-can-add-pages","0")})):u(n,i)}).catch(t=>{console.error(t),u(n,i)})):c(r,t)})}function s(){jQuery(document).on("click",".wpr-ri-retest:not(.wpr-ri-action--disabled), .wpr-ri-retest-link",function(t){t.preventDefault();var e,r,a,t=jQuery(this),i=t.data("url"),n=t.closest(".wpr-ri-column"),s=n.data("rocket-insights-id"),o=t.data("source")||n.data("source");s&&("1"===n.attr("data-has-credit")?(r=i,i=o,p(a=n,e=s),window.wp.apiFetch({path:"/wp-rocket/v1/rocket-insights/pages/"+e,method:"PATCH",data:{source:i}}).then(t=>{t.success?d(e,0,a):u(a,r)}).catch(t=>{console.error(t),u(a,r)})):c(n,t))})}function d(t,e,r){i[t]&&clearInterval(i[t]),i[t]=setInterval(function(){o(t,0,r)},a),o(t,0,r)}function c(t,e){var r=t.find(".wpr-ri-limit-html").html()||window.rocket_insights_i18n?.limit_reached||"";t.find(".wpr-ri-message").html(r).show(),e&&e.prop&&(e.prop("disabled",!0),setTimeout(function(){e.prop("disabled",!1)},3e3))}function o(r,t,a){window.wp.apiFetch({path:window.wp.url.addQueryArgs("/wp-rocket/v1/rocket-insights/pages/progress",{ids:[r]})}).then(t=>{var e;t.success&&Array.isArray(t.results)&&("completed"!==(t=t.results[0]).status&&"failed"!==t.status||(clearInterval(i[r]),delete i[r],e=(t=a).data("url"),u(t,e)))})}function p(t,e){e&&t.attr("data-rocket-insights-id",e);var e=jQuery("<div>").addClass("wpr-ri-loading wpr-btn-with-tool-tip"),r=jQuery("<img>").addClass("wpr-loading-img").attr({src:window.rocket_insights_i18n?.loading_img||"",alt:"Loading..."}),a=jQuery("<div>").addClass("wpr-ri-message").css("display","none");e.append(r),e.append(`<div class="wpr-tooltip"><div class="wpr-tooltip-content">${window.rocket_insights_i18n?.estimated_time_text||"Analyzing your page (~1 min)."}</div></div>`),t.empty().append(e).append(a)}function u(e,t){var r=e.data("post-id");window.wp.apiFetch({path:window.wp.url.addQueryArgs("/wp-rocket/v1/rocket-insights/pages",{url:t,post_id:r})}).then(t=>{t.success&&t.html&&(e.replaceWith(t.html),n(),s())}).catch(t=>{console.error("Failed to reload column:",t)})}return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t(),{init:t}})()},{}]},{},[1]);
//# sourceMappingURL=rocket-insights.min.js.map
