class ConditionalLogic{constructor(e){this.form=e,this.formId=e.getAttribute("form-id"),this.formConditionalData="srfm_conditional_logic_data_"+this.formId,this.conditionalData=window[this.formConditionalData]&&window[this.formConditionalData]["data-"+this.formId]?window[this.formConditionalData]["data-"+this.formId][0]:null,this.conditionalData&&(this.triggerFields=e.querySelectorAll(".conditional-trigger"),this.conditionalFields=e.querySelectorAll(".conditional-logic"),this.conditionalFields.forEach(e=>{e.classList.add("initial-load"),e.classList.contains("srfm-show")&&this.toggleElement(e,"hide"),e.classList.contains("srfm-hide")&&this.toggleElement(e,"show")}),this.triggerFields.forEach(e=>{var t;e.classList.contains("srfm-rating-block")?(t=e.querySelectorAll("input.srfm-input-rating"))&&t.forEach(e=>{e.addEventListener("change",()=>{this.conditionalLogic()})}):e.classList.contains("srfm-multi-choice-block")?(t=e.querySelectorAll(".srfm-input-multi-choice-single"))&&t.forEach(e=>{e.addEventListener("click",()=>{this.conditionalLogic()})}):e.classList.contains("srfm-dropdown-block")?e.querySelector(".srfm-dropdown-input ").addEventListener("change",()=>this.conditionalLogic()):e.classList.contains("srfm-slider-block")&&"text"===e.getAttribute("data-type")?(t=e.querySelectorAll(".srfm-text-slider-option input"))&&t.forEach(e=>{e.addEventListener("change",()=>{this.conditionalLogic()})}):e.classList.contains("srfm-time-picker-block")?(t=e.querySelector(".srfm-input-time-picker"))&&t.addEventListener("change",()=>this.conditionalLogic()):e.querySelector("input,textarea").addEventListener("input",()=>this.conditionalLogic())}),this.conditionalLogic())}timeoutFunction=()=>null;conditionalLogic(){this.timeoutFunction=clearTimeout(this.timeoutFunction),this.timeoutFunction=setTimeout(()=>{this.conditionalData.forEach(e=>{for(var t in e){var i=e[t],t=this.form.querySelector(`[data-block-id="${t}"]`);if(!t)return;var{logic:i,action:r}=i,i=this.evaluateConditions(i);this.toggleBlock(r,i,t)}})},500)}toggleBlock(e,t,i){var r=()=>{i.classList.contains("show-element")||this.animateElement(i,"show")},s=()=>{i.classList.contains("hide-element")||(this.animateElement(i,"hide"),i.classList.remove("initial-load"))};t?("show"===e?r:s)():"show"===e?s():i.classList.contains("initial-load")||r()}animateElement(e,t="show"){"hide"===t?(this.slideUp(e,400),this.toggleElement(e,"hide")):(this.slideDown(e,400),this.toggleElement(e,"show"))}toggleElement(e,t="show"){"hide"===t?(e.classList.add("hide-element"),e.classList.remove("show-element")):(e.classList.add("show-element"),e.classList.remove("hide-element"));t=new CustomEvent("srfm_form_conditional_logic",{detail:{status:t,blockId:e.getAttribute("data-block-id")}});document.dispatchEvent(t)}evaluateConditions(e){return e.some(e=>e.every(e=>this.evaluateCondition(e)))}evaluateCondition(t){var e=this.getFieldValue(t.field).toString();if([">","<","<=",">="].includes(t?.operator)&&(null===e||null===t?.value))return!1;switch(t.operator){case"==":return e===t.value;case"!=":return e!==t.value;case">":return Number(e)>Number(t.value);case"<":return Number(e)<Number(t.value);case"<=":return Number(e)<=Number(t.value);case">=":return Number(e)>=Number(t.value);case"between":var[i,r]=t.value?.split(",").map(e=>e.trim());return null===e||null===i||null===r?!1:Number(e)>=Number(i)&&Number(e)<=Number(r);case"!null":return 0!==e.length;case"null":return 0===e.length;case"includes":return e.includes(t.value);case"!includes":return!e.includes(t.value);case"startWith":return e.startsWith(t.value);case"endWith":return e.endsWith(t.value);case"isChecked":return"true"===e;case"!isChecked":return"false"===e;case"matchesPattern":return new RegExp(t.value).test(e);case"doesNotMatchPattern":return!new RegExp(t.value).test(e);case"in":return(e?.split(" | ").map(e=>e.trim())).some(e=>t.value.includes(e));case"!in":return(e?.split(" | ").map(e=>e.trim())).every(e=>!t.value.includes(e));case"isSelected":return!!e?.trim();case"!isSelected":return!e?.trim();case"datePickerIs":return parseDateTime(e,t)===parseDateTime(t.value);case"timePickerIs":return parseDateTime(e,t)?.getTime()===parseDateTime(t.value)?.getTime();case"isBefore":return parseDateTime(e,t)<parseDateTime(t.value);case"isAfter":return parseDateTime(e,t)>parseDateTime(t.value);case"isOnOrBefore":return parseDateTime(e,t)<=parseDateTime(t.value);case"isOnOrAfter":return parseDateTime(e,t)>=parseDateTime(t.value);default:return!1}}getFieldValue(i){i=this.form.querySelector(`[data-block-id="${i}"]`);if(!i)return"";if(i&&i.classList.contains("srfm-rating-block"))return i.querySelector("input.srfm-input-rating")?.value||"";if(i&&i.classList.contains("srfm-multi-choice-block"))return i.querySelector(".srfm-input-multi-choice-hidden")?.value||"";if(i&&i.classList.contains("srfm-dropdown-block"))return i.querySelector(".srfm-input-dropdown-hidden")?.value||"";if(i&&i.classList.contains("srfm-slider-block")&&"text"===i.getAttribute("data-type")){var r=i.querySelectorAll(".srfm-text-slider-option input");let t=[];return r.forEach(e=>{e.checked&&t.push(e.value.trim())}),t}if(i&&(i.classList.contains("srfm-checkbox-block")||i.classList.contains("srfm-gdpr-block")))return i.querySelector('input[type="checkbox"]').checked.toString();if(i&&i.classList.contains("srfm-phone-block"))return i.querySelector(".srfm-input-phone").value.replaceAll(" ","").replaceAll("-","")||"";if(i&&i.classList.contains("srfm-textarea-block"))return(r=i.querySelector("textarea"))?.getAttribute("data-is-richtext")?i.querySelector(".ql-editor").textContent||"":r.value||"";r=i.querySelector("input,select");if(!r)return"";if(r.classList.contains("srfm-input-number")){i=r.getAttribute("format-type")||"us-style";let e=r.value;return e?("eu-style"===i?e=e.replace(/\./g,"").replace(/,/g,"."):"us-style"===i&&(e=e.replace(/,/g,"")),e):""}return r.value||""}slideUp(e,t=400){e.style.height=e.offsetHeight+"px",e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.boxSizing="border-box",e.style.overflow="hidden",setTimeout(()=>{e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0},10),setTimeout(()=>{e.style.display="none",e.style.removeProperty("height"),e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property")},t)}slideDown(e,t=400){e.style.removeProperty("display"),"none"===window.getComputedStyle(e).display&&(e.style.display="block");let i=e.offsetHeight;e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,e.style.overflow="hidden",e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.boxSizing="border-box",setTimeout(()=>{e.style.height=i+"px",e.style.paddingTop="",e.style.paddingBottom="",e.style.marginTop="",e.style.marginBottom=""},10),setTimeout(()=>{e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property")},t)}}function parseDateTime(s,n=null){if(s){if(s.includes(":")){var a=s.split(":");let e=parseInt(a[0]);a=parseInt(a[1]);return s.includes("PM")&&e<12?e+=12:s.includes("AM")&&12===e&&(e=0),new Date(0,0,0,e,a)}let e,t,i,r;if(null===n)r=s.split("-"),i=parseInt(r[0]),t=parseInt(r[1])-1,e=parseInt(r[2]);else{a=document.querySelector('[data-block-id="'+n.field+'"] .srfm-input-datepicker');if(!a)return;n=a.getAttribute("data-date-format");if(r=s.split("/"),"dd/mm/yyyy"===n)e=parseInt(r[0]),t=parseInt(r[1])-1;else{if("mm/dd/yyyy"!==n)return;t=parseInt(r[0])-1,e=parseInt(r[1])}i=parseInt(r[2])}return+new Date(i,t,e)}}function skipHiddenConditionalFieldValidation(e){return e.classList.contains("conditional-logic")&&e.classList.contains("hide-element")}function skipHiddenAddressFieldValidation(e){e=e.closest(".srfm-address-block");return e&&skipHiddenConditionalFieldValidation(e)}function registerSkipValidationCallback(e){"function"==typeof e&&(void 0===window.sureforms&&(window.sureforms={}),Array.isArray(window.sureforms.skipValidationCallbacks)||(window.sureforms.skipValidationCallbacks=[]),window.sureforms.skipValidationCallbacks.push(e))}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".srfm-form").forEach(e=>new ConditionalLogic(e)),registerSkipValidationCallback(skipHiddenConditionalFieldValidation),registerSkipValidationCallback(skipHiddenAddressFieldValidation)});