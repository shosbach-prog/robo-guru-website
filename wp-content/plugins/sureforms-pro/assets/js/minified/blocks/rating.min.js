function initializeRatings(){var e=document.querySelectorAll(".srfm-rating-block");e&&e.forEach(e=>{var t=e.querySelectorAll(".srfm-icon");setDefaultRating(e),t&&t.forEach(t=>{t.addEventListener("click",function(e){handleSingleRating(e,"click")}),t.addEventListener("mouseover",function(e){handleSingleRating(e,"hover")}),t.addEventListener("mouseout",function(e){handleSingleRating(e,"mouse-out")}),t.addEventListener("keydown",function(e){" "===e.key&&(handleSingleRating(e,"keydown"),e.preventDefault()),"ArrowLeft"!==e.key&&"ArrowRight"!==e.key||(e.preventDefault(),("ArrowLeft"===e.key?t?.closest("li")?.previousElementSibling:t?.closest("li")?.nextElementSibling)?.querySelector(".srfm-icon")?.focus())})})})}function handleSingleRating(e,t){e=e.currentTarget;let i=e.closest("ul");var l=i.getAttribute("data-icon-type");let r=i.getAttribute("data-icon-labels");if(r)try{r=JSON.parse(r)}catch(e){r=[],console.error("Invalid JSON: ",e)}var s=i.children,a=parseInt(e.getAttribute("data-value"));let n=e.closest(".srfm-block").querySelector(".srfm-input-rating");var o=parseInt(n.getAttribute("value"));function f(l){n.setAttribute("value",l);i.querySelectorAll(".srfm-icon").forEach(e=>{var t=parseInt(e.getAttribute("data-value"));e.setAttribute("aria-checked",t===l?"true":"false")});var e=new Event("change",{bubbles:!1}),e=(n.dispatchEvent(e),wp.a11y.speak(window?.srfm?.srfmSprintfString(window?.srfm_submit?.messages?.rating_selected_value,r[l-1])),n.closest(".srfm-block"));e&&window?.srfm?.toggleErrorState(e,!1)}if(a&&n)if("star"===l){if("hover"===t)for(let e=0;e<a;e++)s[e].classList.add("srfm-fill");else if("mouse-out"===t)for(let e=0;e<s.length;e++)e<o||s[e].classList.remove("srfm-fill");else if("click"===t||"keydown"===t){f(a);for(let e=0;e<s.length;e++)e<a?s[e].classList.add("srfm-fill"):s[e].classList.remove("srfm-fill")}}else if("hover"===t)e.closest("li").classList.add("srfm-fill");else if("mouse-out"===t)a!==o&&e.closest("li").classList.remove("srfm-fill");else if("click"===t||"keydown"===t){f(a);for(let e=0;e<s.length;e++)s[e].classList.remove("srfm-fill");e.closest("li").classList.add("srfm-fill")}}function setDefaultRating(e){var t=e.querySelector(".srfm-input-rating"),e=e.querySelector("ul"),l=e.getAttribute("data-icon-type");if(t&&("star"===l||"smiley"===l)){var i=parseInt(t.getAttribute("value"));if(i){var r=e.children;if("star"===l)for(let e=0;e<i;e++)r[e].classList.add("srfm-fill");else r[i-1]?.classList.add("srfm-fill")}}}document.addEventListener("srfm_form_before_submission",e=>{e=e.detail?.form.querySelectorAll(".srfm-input-rating");e&&0!==e.length&&setTimeout(()=>{initializeRatings()},100)});