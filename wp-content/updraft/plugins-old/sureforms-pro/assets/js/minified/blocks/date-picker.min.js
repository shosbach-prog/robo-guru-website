import{addFilter}from"@wordpress/hooks";function initializeDatePicker(){let p=document.querySelectorAll(".srfm-datepicker-block");if(p.length){let u={weekday:"long",year:"numeric",month:"long",day:"numeric"},y=navigator.language||"en-US",c;"undefined"!=typeof Intl&&Intl.DateTimeFormat&&(c=new Intl.DateTimeFormat(y,u)),p.forEach(i=>{let n=i.querySelector(".srfm-input-datepicker");if(n){var i=n.getAttribute("max"),o=n.getAttribute("min"),s=n.getAttribute("data-date-format"),d=getDisabledDays(n),l="true"===n.getAttribute("data-disable-past");let t=window?.innerWidth<768,e=o;l&&((l=new Date).setHours(0,0,0,0),e=o&&new Date(o).getTime()>l.getTime()?o:l);o='<svg aria-hidden="true" viewBox="0 0 6 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 9L1 5L5 1" stroke-width="0.833333" stroke-linecap="round" stroke-linejoin="round"/></svg>',l='<svg aria-hidden="true" viewBox="0 0 6 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 9L5 5L1 1" stroke-width="0.833333" stroke-linecap="round" stroke-linejoin="round"/></svg>';let r=new Datepicker(n,{format:s,autohide:!0,prevArrow:srfm_submit.is_rtl?l:o,nextArrow:srfm_submit.is_rtl?o:l,...e&&{minDate:e},...i&&{maxDate:i},daysOfWeekDisabled:d,shortcutKeys:{show:{key:" "},hide:{key:"Escape"},toggle:{key:null}}});var m={clearIncomplete:!0,showMaskOnHover:!1,showMaskOnFocus:!1};switch(s){case"dd/mm/yyyy":m.alias="datetime",m.inputFormat="dd/mm/yyyy";break;case"mm/dd/yyyy":m.alias="datetime",m.inputFormat="mm/dd/yyyy"}new Inputmask(m).mask(r.element);let a=document.createElement("input");a.required="true",a.style.display="none",r.element.addEventListener("show",()=>{t&&n.setAttribute("readonly","true"),n.parentElement.append(a),r.picker.element.getAttribute("aria-hidden")||r.picker.element.setAttribute("aria-hidden","true")}),r.element.addEventListener("keydown",t=>{if("ArrowLeft"===t.key||"ArrowRight"===t.key||"ArrowUp"===t.key||"ArrowDown"===t.key){t=r.getFocusedDate();if(t){let e="";e=c?c.format(t):t.toLocaleDateString(y,u),wp.a11y.speak(e,"polite")}}}),r.element.addEventListener("hide",()=>{t&&n.removeAttribute("readonly");var e=new Event("input",{bubbles:!1,cancelable:!0});n.dispatchEvent(e),setTimeout(()=>{a.remove()},1)}),n.oninput=function(e){e=e.target.value.replaceAll("/","-");n.setAttribute("value",e),p.forEach(e=>{window?.srfm?.toggleErrorState(e,!1)})},r.element.addEventListener("focusout",()=>{r?.hide()})}})}}function getDisabledDays(e){let r=[];var a,e=e.getAttribute("data-days-enabled");if(e)try{let t=JSON.parse(e);Array.isArray(t)&&t.length&&(a=[0,1,2,3,4,5,6],r=a.filter(e=>!t.includes(e)))}catch(e){console.error("Invalid JSON format for data-days-enabled:",e)}return r}function parseAndValidateDate(e,t,r,a){return 3!==e.length||(t=parseInt(e[t],10),r=parseInt(e[r],10),e=parseInt(e[a],10),(a=new Date(t,r-1,e)).getFullYear()!==t)||a.getMonth()!==r-1||a.getDate()!==e?null:a}window.srfmInitializeDatePicker=initializeDatePicker,document.addEventListener("srfm_form_before_submission",e=>{e.detail?.form.querySelectorAll(".srfm-input-datepicker")&&setTimeout(()=>{initializeDatePicker()},100)}),addFilter("srfm.modifyFieldValidationResult","sureforms-pro/datepicker-past-date-validation",(e,t,r)=>{if(t.classList.contains("srfm-datepicker-block")){var a=t.querySelector(".srfm-input-datepicker");if("true"===a?.getAttribute("data-disable-past")){var i=a?.value?.trim();if(i){var n={"mm/dd/yyyy":{year:2,month:0,day:1},"dd/mm/yyyy":{year:2,month:1,day:0}}[a.getAttribute("data-date-format")];if(n){i=parseAndValidateDate(i.split(/[\/\-]/),n.year,n.month,n.day);if(i&&!isNaN(i.getTime())){i.setHours(0,0,0,0);n=new Date;if(n.setHours(0,0,0,0),i<n)return a&&window?.srfm?.toggleErrorState(a.closest(".srfm-block"),!0),(i=t.querySelector(".srfm-error-message"))&&(i.textContent=window?.srfm_submit?.messages?.date_picker_past_dates_not_allowed),r(a,t),!0}}}}}return e});