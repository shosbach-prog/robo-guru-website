window.bp=window.bp||{},window.OneSignal=window.OneSignal||[];var bb_player_id="";!function(i){bp.OneSignal_FrontCommon={start:function(){this.setupGlobals(),this.addListeners(),i(document).on("ready",function(){i.magnificPopup.defaults.closeOnBgClick=!1,""===bb_player_id&&(bb_player_id=bp.OneSignal_FrontCommon.getCookie("bbpro-player-id"))})},setupGlobals:function(){bp.OneSignal_FrontCommon.is_updated_device_info=!1,window.OneSignal.push(function(){window.OneSignal.on("subscriptionChange",function(o){window.OneSignal.push(function(){window.OneSignal.getUserId(function(n){bb_player_id=n,o?(window.OneSignal.push(["setSubscription",!0]),bp.OneSignal_FrontCommon.updateDeviceInfo(bb_player_id,!0,!0)):bp.OneSignal_FrontCommon.updateDeviceInfo(bb_player_id,!1,!0)})})}),window.OneSignal.isPushNotificationsEnabled(function(o){window.OneSignal.getUserId(function(n){bp.OneSignal_FrontCommon.is_updated_device_info=!0,bb_player_id=n,o?(window.OneSignal.push(["setSubscription",!0]),bp.OneSignal_FrontCommon.updateDeviceInfo(bb_player_id,!0,!0)):bp.OneSignal_FrontCommon.updateDeviceInfo(bb_player_id,!1,!0)})})}),window.OneSignal.push(function(){window.OneSignal.SERVICE_WORKER_UPDATER_PATH="OneSignalSDKUpdaterWorker.js",window.OneSignal.SERVICE_WORKER_PATH="OneSignalSDKWorker.js",window.OneSignal.SERVICE_WORKER_PARAM={scope:bb_onesignal_vars.path+"/sdk_files/push/onesignal/"},window.OneSignal.setDefaultNotificationUrl(bb_onesignal_vars.home_url);function n(){window.OneSignal.init(window._oneSignalInitOptions),window.OneSignal.setExternalUserId(bb_onesignal_vars.prompt_user_id),0<parseInt(bb_onesignal_vars.auto_prompt_request_permission)&&("visit"===bb_onesignal_vars.auto_prompt_validate||"login"===bb_onesignal_vars.auto_prompt_validate&&"true"!==sessionStorage.getItem("ONESIGNAL_HTTP_PROMPT_SHOWN"))&&bp.OneSignal_FrontCommon.notificationPrompt()}var o={},o=((window._oneSignalInitOptions=o).appId=bb_onesignal_vars.app_id,o.allowLocalhostAsSecureOrigin=!0,o.path=bb_onesignal_vars.http_path+"sdk_files/",o.safari_web_id=bb_onesignal_vars.safari_web_id,bb_onesignal_vars.subDomainName&&(o.subdomainName=bb_onesignal_vars.subDomainName),0<parseInt(bb_onesignal_vars.is_soft_prompt_enabled)&&(o.promptOptions={},o.promptOptions.actionMessage=bb_onesignal_vars.actionMessage,o.promptOptions.acceptButtonText=bb_onesignal_vars.acceptButtonText,o.promptOptions.cancelButtonText=bb_onesignal_vars.cancelButtonText),"Safari"===bp.OneSignal_FrontCommon.detectBrowser());o&&(document.querySelector("video, iframe, embed, object")||document.querySelector('.wp-video, .wp-block-embed, [class*="video"], [class*="embed"], [class*="player"], [class*="iframe"]'))?"complete"===document.readyState?setTimeout(n,1500):window.addEventListener("load",function(){setTimeout(n,1500)}):"complete"===document.readyState?n():i(document).ready(n)}),window.OneSignal.push(function(){window.OneSignal.on("notificationPermissionChange",function(n){n=n.to;bb_player_id&&("granted"===n?(window.OneSignal.push(["setSubscription",!0]),bp.OneSignal_FrontCommon.updateDeviceInfo(bb_player_id,!0,!0)):("denied"===n&&window.OneSignal.push(["setSubscription",!1]),bp.OneSignal_FrontCommon.updateDeviceInfo(bb_player_id,!1,!0)))})})},addListeners:function(){i(document).on("change",".notification-toggle",this.toggleNotifcationOnOff.bind(this)),i(document).on("click","body .mfp-inline-holder",this.disableMagificPopupBackgroundClick.bind(this)),i(document).on("click",".mfp-close",this.enableMagificPopupBackgroundClick.bind(this)),i(document).on("click","#onesignal-slidedown-cancel-button",function(){i("body .notification-toggle").prop("checked",!1)}),i(window).on("load",this.handleNotificationToggle.bind(this))},disableMagificPopupBackgroundClick:function(){1<=i(".mfp-bg").length&&i("body, html").css("overflow","hidden")},enableMagificPopupBackgroundClick:function(){i("body, html").css("overflow","inherit")},toggleNotifcationOnOff:function(n){i(n.target).is(":checked")?"denied"!==bp.OneSignal_FrontCommon.getUserNotificationStatus()?(localStorage.removeItem("onesignal-notification-prompt"),bp.OneSignal_FrontCommon.notificationPrompt()):i("#permission-helper-modal").magnificPopup({items:{src:i("#permission-helper-modal"),type:"inline",closeOnContentClick:!1,closeBtnInside:!0,enableEscapeKey:!1,closeOnBgClick:!1},callbacks:{open:function(){i(".notification-popup .mfp-close").click(function(){bp.OneSignal_FrontCommon.closeMfpPopup()}),"granted"===bp.OneSignal_FrontCommon.getUserNotificationStatus()?i(".notification-popup .turn-on-button").removeAttr("disabled"):window.OneSignal.showNativePrompt(),i(".notification-popup .turn-on-button").click(function(){window.OneSignal.push(["setSubscription",!0]),setTimeout(function(){bp.OneSignal_FrontCommon.closeMfpPopup()},300)})},close:function(){"granted"===bp.OneSignal_FrontCommon.getUserNotificationStatus()?i("body .notification-toggle").prop("checked",!0):i("body .notification-toggle").prop("checked",!1)}}}).magnificPopup("open"):i("#permission-helper-modal-close").magnificPopup({items:{src:i("#permission-helper-modal-close"),type:"inline",closeOnContentClick:!1,closeBtnInside:!0,enableEscapeKey:!1,closeOnBgClick:!1},callbacks:{open:function(){i(".notification-popup-close .mfp-close").click(function(){bp.OneSignal_FrontCommon.closeMfpPopup()}),"disabled"!==bp.OneSignal_FrontCommon.getUserNotificationStatus()&&"default"!==bp.OneSignal_FrontCommon.getUserNotificationStatus()||i(".notification-popup-close .turn-on-button-close").removeAttr("disabled"),i(".notification-popup-close .turn-on-button-close").click(function(){window.OneSignal.push(["setSubscription",!1]),setTimeout(function(){bp.OneSignal_FrontCommon.closeMfpPopup()},300)})},close:function(){"granted"===bp.OneSignal_FrontCommon.getUserNotificationStatus()?i("body .notification-toggle").prop("checked",!0):i("body .notification-toggle").prop("checked",!1)}}}).magnificPopup("open")},closeMfpPopup:function(){0<i(document).find(".notification-popup  button.turn-on-button").length&&i(document).find(".notification-popup  button.turn-on-button").is(":disabled")&&i("body .notification-toggle").prop("checked",!1),i.magnificPopup.close()},notificationPrompt:function(){"undefined"!=typeof Notification&&("http:"===location.protocol||"granted"!==Notification.permission&&"denied"!==Notification.permission)&&0<parseInt(bb_onesignal_vars.is_component_active)&&0<parseInt(bb_onesignal_vars.is_web_push_enable)&&0<parseInt(bb_onesignal_vars.is_valid_licence)&&0<parseInt(bb_onesignal_vars.prompt_user_id)&&(0<parseInt(bb_onesignal_vars.is_soft_prompt_enabled)?window.OneSignal.showSlidedownPrompt():window.OneSignal.showNativePrompt())},getUserNotificationStatus:function(){return"undefined"!=typeof Notification?Notification.permission:""},updateDeviceInfo:function(n,o,e){i.ajax({type:"POST",url:bb_onesignal_vars.ajax_url,data:{action:"onesignal_update_device_info",user_id:bb_onesignal_vars.prompt_user_id,player_id:n,active:o,update_via_curl:e},success:function(n){void 0!==n.data&&n.data.browser_box&&0<i(document).find(".bb-onesignal-render-browser-block").length&&i(document).find(".bb-onesignal-render-browser-block").empty().append(n.data.browser_box).removeClass("bp-hide")},error:function(){return!1}})},detectBrowser:function(){return-1!==navigator.userAgent.indexOf("Opera")||-1!==navigator.userAgent.indexOf("OPR")?"Opera":-1!==navigator.userAgent.indexOf("Edge")||-1!==navigator.userAgent.indexOf("Edg")?"Edge":-1!==navigator.userAgent.indexOf("Chrome")?"Chrome":-1!==navigator.userAgent.indexOf("Safari")?"Safari":-1!==navigator.userAgent.indexOf("Firefox")?"Firefox":-1!==navigator.userAgent.indexOf("MSIE")||void 0!==document.documentMod?"IE":"Unknown"},getCookie:function(n){for(var o=n+"=",e=decodeURIComponent(document.cookie).split(";"),i=0;i<e.length;i++){for(var t=e[i];" "==t.charAt(0);)t=t.substring(1);if(0==t.indexOf(o))return t.substring(o.length,t.length)}return""},setCookie:function(n,o,e){var i=new Date,e=(i.setTime(i.getTime()+24*e*60*60*1e3),"expires="+i.toUTCString());document.cookie=n+"="+o+"; "+e+"; path=/"},handleNotificationToggle:function(){setTimeout(function(){bp.OneSignal_FrontCommon.is_updated_device_info||bp.OneSignal_FrontCommon.updateDeviceInfo("",!1,!1)},1e3)}},bp.OneSignal_FrontCommon.start()}((bp,jQuery));