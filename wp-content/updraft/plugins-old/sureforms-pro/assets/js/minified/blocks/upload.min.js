function initializeUploadField(){var e=document.querySelectorAll(".srfm-upload-block");e&&e.forEach(a=>{let l=a.querySelector(".srfm-upload-size"),d=a.querySelector(".srfm-input-upload"),p=[],m=d.getAttribute("accept")?.split(",").map(e=>e.trim())||[],t=(m=m.filter(Boolean).map(e=>e.startsWith(".")?e.slice(1):e),window?.srfmProBlocksData?.allowed_mime_types);t&&(m=m.flatMap(e=>t[e]?t[e].split("|").map(e=>e.trim()):e)),d&&l&&d.addEventListener("change",e=>{e=Array.from(e.target.files);let t=1024*parseInt(l.value)*1024,o=parseInt(d.getAttribute("multiple")?d.getAttribute("multiple"):1),r=a.querySelector(".srfm-error-message"),i=(window?.srfm?.toggleErrorState(a,!1),r&&(r.textContent=""),e.forEach(s=>{let n=document.createElement("div");if(n.classList.add("srfm-upload-data"),s.size>t)window?.srfm?.toggleErrorState(a,!0),r&&(r.textContent=window?.srfm?.srfmSprintfString(window?.srfm_submit?.messages?.srfm_file_size_exceed,l.value));else if(m.every(e=>""===e)||m.includes(s.type))if(p.length>=o)window?.srfm?.toggleErrorState(a,!0),r&&(r.textContent=window?.srfm?.srfmSprintfString(window?.srfm_submit?.messages?.srfm_file_upload_limit,o));else{p.push(s);let i=20<s.name.length?s.name.substring(0,17)+"..."+s.name.split(".").pop():s.name;var e=new FileReader;e.onload=function(e){var e=e.target.result,e=s.type.startsWith("image/")?`<img class="srfm-upload-data-image" src="${e}"/>`:getFileSvg(s.type),t=(s.size/1e6).toFixed(2),t=window?.srfm?.srfmSprintfString(window?.srfm_submit?.messages?.size_mb,t),o=window?.srfm?.srfmSprintfString(window?.srfm_submit?.messages?.delete_string,i);let r=window?.srfm?.srfmSprintfString(window?.srfm_submit?.messages?.delete_file,i);n.innerHTML=`
									<div class="srfm-upload-data-left">
										<div class="srfm-upload-preview">${e}</div>
										<div class="srfm-upload-data-details">
											<div class="srfm-upload-data-filename">${i}</div>
											<div class="srfm-upload-data-size">
											${t}
										</div>
										</div>
									</div>
									<button title="${o}" style="background: none; border: none; padding: 0; font-size: 20px;" class="srfm-upload-data-right srfm-upload-delete">
										<svg width='20' height='20' viewBox='0 0 20 20' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M2.5 5H17.5' stroke='#1E1E1E' stroke-opacity='0.65' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/><path d='M15.8337 5V16.6667C15.8337 17.5 15.0003 18.3333 14.167 18.3333H5.83366C5.00033 18.3333 4.16699 17.5 4.16699 16.6667V5' stroke='#1E1E1E' stroke-opacity='0.65' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/><path d='M6.66699 5.00033V3.33366C6.66699 2.50033 7.50033 1.66699 8.33366 1.66699H11.667C12.5003 1.66699 13.3337 2.50033 13.3337 3.33366V5.00033' stroke='#1E1E1E' stroke-opacity='0.65' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/><path d='M8.33301 9.16699V14.167' stroke='#1E1E1E' stroke-opacity='0.65' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/><path d='M11.667 9.16699V14.167' stroke='#1E1E1E' stroke-opacity='0.65' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/></svg>
									</button>`,a.appendChild(n),n.style.display="flex",n.querySelector(".srfm-upload-delete").addEventListener("click",()=>{wp.a11y.speak(r);var e=p.indexOf(s);-1<e&&p.splice(e,1),n.remove(),a.querySelector(".srfm-upload-data")||(d.value="",window?.srfm?.toggleErrorState(a,!1));let t=new DataTransfer;p.forEach(e=>t.items.add(e)),d.files=t.files})},e.readAsDataURL(s)}else window?.srfm?.toggleErrorState(a,!0),r&&(r.textContent=window?.srfm_submit?.messages?.srfm_file_type_not_allowed)}),new DataTransfer);p.forEach(e=>i.items.add(e)),d.files=i.files})})}function getFileSvg(e){return e.startsWith("video/")?"<svg width='20' height='20' viewBox='0 0 20 20' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M12.083 1.66699H4.99967C4.55765 1.66699 4.13372 1.84259 3.82116 2.15515C3.5086 2.46771 3.33301 2.89163 3.33301 3.33366V16.667C3.33301 17.109 3.5086 17.5329 3.82116 17.8455C4.13372 18.1581 4.55765 18.3337 4.99967 18.3337H14.9997C15.4417 18.3337 15.8656 18.1581 16.1782 17.8455C16.4907 17.5329 16.6663 17.109 16.6663 16.667V6.25033L12.083 1.66699Z' stroke='#1E1E1E' stroke-opacity='0.5' stroke-linecap='round' stroke-linejoin='round'/><path d='M11.667 1.66699V6.66699H16.667' stroke='#1E1E1E' stroke-opacity='0.5' stroke-linecap='round' stroke-linejoin='round'/><path d='M8.33301 9.16699L12.4997 11.667L8.33301 14.167V9.16699Z' stroke='#1E1E1E' stroke-opacity='0.5' stroke-linecap='round' stroke-linejoin='round'/></svg>":["application/x-tar","application/zip","application/x-gzip","application/rar","application/x-7z-compressed"].includes(e)?"<svg width='20' height='20' viewBox='0 0 20 20' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M3.33301 18.3337V3.33366C3.33301 2.91699 3.49967 2.50033 3.83301 2.16699C4.16634 1.83366 4.58301 1.66699 4.99967 1.66699H12.083L16.6663 6.25033V16.667C16.6663 17.0837 16.4997 17.5003 16.1663 17.8337C15.833 18.167 15.4163 18.3337 14.9997 18.3337H13.333' stroke='#1E1E1E' stroke-opacity='0.5' stroke-linecap='round' stroke-linejoin='round'/><path d='M11.667 1.66699V6.66699H16.667' stroke='#1E1E1E' stroke-opacity='0.5' stroke-linecap='round' stroke-linejoin='round'/><path d='M8.33366 18.3333C9.25413 18.3333 10.0003 17.5871 10.0003 16.6667C10.0003 15.7462 9.25413 15 8.33366 15C7.41318 15 6.66699 15.7462 6.66699 16.6667C6.66699 17.5871 7.41318 18.3333 8.33366 18.3333Z' stroke='#1E1E1E' stroke-opacity='0.5' stroke-linecap='round' stroke-linejoin='round'/><path d='M8.33301 5.83333V5' stroke='#1E1E1E' stroke-opacity='0.5' stroke-linecap='round' stroke-linejoin='round'/><path d='M8.33301 10.0003V9.16699' stroke='#1E1E1E' stroke-opacity='0.5' stroke-linecap='round' stroke-linejoin='round'/><path d='M8.33301 14.9997V13.333' stroke='#1E1E1E' stroke-opacity='0.5' stroke-linecap='round' stroke-linejoin='round'/></svg>":"<svg width='20' height='20' viewBox='0 0 20 20' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M12.083 1.66699H4.99967C4.55765 1.66699 4.13372 1.84259 3.82116 2.15515C3.5086 2.46771 3.33301 2.89163 3.33301 3.33366V16.667C3.33301 17.109 3.5086 17.5329 3.82116 17.8455C4.13372 18.1581 4.55765 18.3337 4.99967 18.3337H14.9997C15.4417 18.3337 15.8656 18.1581 16.1782 17.8455C16.4907 17.5329 16.6663 17.109 16.6663 16.667V6.25033L12.083 1.66699Z' stroke='#1E1E1E' stroke-opacity='0.5' stroke-linecap='round' stroke-linejoin='round'/><path d='M11.667 1.66699V6.66699H16.667' stroke='#1E1E1E' stroke-opacity='0.5' stroke-linecap='round' stroke-linejoin='round'/></svg>"}document.addEventListener("DOMContentLoaded",initializeUploadField);